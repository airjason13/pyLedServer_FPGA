<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIS</title>

    <!-- <script src="static/script.js" defer></script> -->
    <script type="text/javascript" src="static/playlist.js"></script>
    <script src="static/js/jquery-3.6.4.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/sweetalert2.min.js"></script>
    <script src="static/contextMenu/jquery.contextMenu.min.js"></script>
    <script src="static/contextMenu/jquery.ui.position.min.js"></script>
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/contextMenu/jquery.contextMenu.min.css" rel="stylesheet">
    <link href="static/css/all.min.css" rel="stylesheet">
    <link href="static/css/sweetalert2.min.css" rel="stylesheet">

    <style>
        body{
            /* background-color: #000000; */
		    text-align: center;
            justify-content: center;
            margin: auto;
            font-family: "Microsoft JhengHei", sans-serif; /*"Comic Sans MS"*/
        }

        h1, h2{
            color: #3C3C3C;
        }
        h5{
            font-size: 6.5vmin;
        }
        img{
            /* width: 50vw; */
            /* height: 200px; */
            border-radius: 15px;
        }

        #carouselCaptions{
            width: 90vw;
            margin: auto;
        }

        .context{
		    text-align: left;
        }

        .imgText{
            color: #ffeb38;
            font-weight: bold;
        }

        .hight-light {
            /* 前 50% 是透明 ( transparent ) ，後 50% 才是有顏色的 */
            /* % 數比例跟色碼可以依照自己需求變更 */
            background-image: linear-gradient(transparent 50%, #FFECF5 50%);

            /* 下面是做一些偏移，依每人需求而定 */
            margin: 0rem 0.25rem;
            padding: 0rem 0.25rem;
        }
        .item {
            background-color: #FFECF5;
            border: none;
            border-radius: 15px;
            color: #7B7B7B;
            text-align: center;
            display: inline-block;
            font-size: 5vmin;
            margin: 3vw 0vw;
            width: 40vw;
            height: 20vh;
        }
        .item:active {
            background-color: #FFFFFF;
            transform: translateY(4px);
        }
        button:disabled {
            background-color: #E0E0E0;
            border: none;
            border-radius: 15px;
            color: #7B7B7B;
            text-align: center;
            display: inline-block;
            font-size: 5vmin;
            margin: 3vw 0vw;
            width: 40vw;
            height: 20vh;
            opacity: 0.6;
            cursor: not-allowed;
        }
        .modalImg{
            width: 50vmin;
        }
        .contextMediaFile{
            /* display: flex; */
            text-align: justify;
        }
        /* .svgImg{
            width: 8vmin;
            filter: invert(5%) sepia(78%) saturate(6858%) hue-rotate(276deg) brightness(97%) contrast(101%);
        } */
    </style>
</head>

<body>
    </br>
    <h1><b class="hight-light" style="font-size: 6.5vmin">LED Control Web</b></h1>
    <h2><b>{{sw_version}}</b></h2>

    <div id="carouselCaptions" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
          {% for i in range(files|length) %}
              <button type="button" data-bs-target="#carouselCaptions" data-bs-slide-to="{{i}}" class="active" aria-current="true" aria-label="Slide {{i}}"></button>
          {% endfor %}
        </div>

        <div class="carousel-inner carousel-fade">
        {% for k,v in files.items() %}
            <!-- 如果是第一個值 -->
            {% if k == files|first %}
                <div class="carousel-item active">
            {% else %}
                <div class="carousel-item">
            {% endif %}
            <img src="./get_thumbnail/{{v}}" class="d-block w-100 contextMediaFile" name="{{k}}" onclick="play(name)">
                <div class="carousel-caption">
                <p class="imgText">{{k}}</p>
                </div>
            </div>
        {% endfor %}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselCaptions" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselCaptions" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
    </div>

    <table style="width:100vw" class="table">
        <tr>
            <td>

                <button value="btn_hdmi_in_start" class="item" style="background-color: #ECECFF;" onclick="submit_hdmi_in(value)">
                  HDMI-In Start
                </button>

            </td>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#playList" class="item" onclick="">
                    <!-- <img src="svg/music-note-list.svg" class="svgImg"> -->
                  Playlist
                </button>
            </td>
        </tr>
        <tr>
            <td>

                <button data-bs-toggle="modal" data-bs-target="#brightnessMode" class="item">
                  Brightness Mode
                </button>

            </td>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#defaultPlayMode" class="item">
                  Default Mode Setting
                </button>
            </td>

        </tr>
        <tr>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#mediaFileUpload" class="item">
                    Media File Upload
                </button>
            </td>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#id_frame_res_fps" class="item">
                    Set RES/FPS
                </button>
            </td>

        </tr>

        <tr>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#id_image_period" class="item">
                    Still Image Period
                </button>
            </td>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#id_icled_type_gain" class="item">
                    ICLed Type/Gain
                </button>
            </td>
        </tr>
        <tr>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#id_media_crop" class="item">
                    Media File Crop
                </button>
            </td>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#id_hdmi_crop" class="item">
                    HDMI_In Crop
                </button>
            </td>
        </tr>
        <tr>
            <td>
                <button data-bs-toggle="modal" data-bs-target="#id_audio_preview" class="item">
                    Audio/Preview
                </button>
            </td>

        </tr>
    </table>

    <!-- Playlist Modal -->
    <div class="modal fade" id="playList" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticPlayList" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticPlayList">View Playlist</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating">
                    <select class="form-select" id="floatingPlaylistName" onchange="onchangePlaylist()">
                      <option selected disabled>Choose a playlist</option>
	                  {% for k,v in playlist_nest_dict.items() %}
                      <option value="{{v}}">{{k}}</option>
	                  {% endfor %}
                    </select>
                    <label for="floatingPlaylistName">Playlist Name</label>
                </div>
                </br>
                <div id="modalImgDiv">
                    <!-- 插入playlist -->
                </div>
            </div>
            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">
                    <!-- delete playlist -->
                    <button type="button" id="removePlaylist" data-bs-dismiss="modal"  class="btn btn-danger" onclick="remove_playlist()">Remove playlist</button>
                    <!-- play this playlist -->
                    <button type="button" id="playPlaylist" class="btn btn-primary" data-bs-dismiss="modal" onclick="play_playlist()">Play</button>
                    <!-- <button type="submit" id="newPlaylist" class="btn btn-primary" data-bs-dismiss="modal" onclick="createPlaylist()">New a playlist</button> -->
                    <!-- add to playlist -->
                    <!-- <button type="submit" id="addToPlaylist" class="btn btn-primary" data-bs-dismiss="modal" onclick="add_to_playlist(name, playlist)">Add To Playlist</button> -->
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- 調亮度Modal -->
    <div class="modal fade" id="brightnessValue" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBrightnessValue" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBrightnessValue">Brightness Setting</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingFrameBrightness" onchange="checkValue0_100(this.id)" value={{ brightnessvalues.frame_brightness }}>
                    <label for="floatingFrameBrightness">Frame Brightness</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingNightModeFrameBrightness" onchange="checkValue0_100(this.id)" value={{ brightnessvalues.night_mode_frame_brightness }}>
                    <label for="floatingNightModeFrameBrightness">Night Mode</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingDayModeFrameBrightness" placeholder="25" onchange="checkValue0_100(this.id)" value={{ brightnessvalues.day_mode_frame_brightness }}>
                    <label for="floatingDayModeFrameBrightness">Day Mode</label>
                </div>
                <div class="form-floating">
                    <input type="number" class="form-control" id="floatingSleepModeFrameBrightness" placeholder="25" onchange="checkValue0_100(this.id)" value={{ brightnessvalues.sleep_mode_frame_brightness }}>
                    <label for="floatingSleepModeFrameBrightness">Sleep Mode</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" onclick="submit_frame_brightness_values_option()">Submit</button>
            </div>
        </div>
        </div>
    </div>

        <!-- 亮度模式Modal -->
    <div class="modal fade" id="brightnessMode" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBrightnessMode" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBrightnessMode">Brightness Mode</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- <form> -->
                    <div class="form-floating">
                        <select class="form-select" id="floatingCity" onchange=""> <!-- submit_target_city_option() -->
						<option selected value={{form.city_selectfiled.data}} disabled>{{form.city_selectfiled.data}}</option>
						{% for i in range(form.city_selectfiled.choices|length) %}
						<option value={{form.city_selectfiled.choices[i]}}>{{form.city_selectfiled.choices[i]}}</option>
						{% endfor %}

                        </select>
                        <label for="floatingCity">City</label>
                    </div>

                    <div class="form-floating mt-2">
                        <select class="form-select" id="floatingBrightnessMode" onchange="selectBrightnessMode();"> <!-- submit_frame_brightness_mode_option(); -->
                        <option value={{form.brightness_mode_switcher.data}} selected disabled>{{form.brightness_mode_switcher.data}}</option>

	         <!-- <option selected disabled>Choose a Mode</option> -->
	         {% for k,v in form.brightness_mode_switcher.choices %}
                        <option value="{{k}}">{{v}}</option>
	         {% endfor %}
                        <!-- <option value="1">Time Mode</option>
                        <option value="0">Fix Mode</option> -->
                        </select>
                        <label for="floatingBrightnessMode">Brightness Mode</label>
                    </div>

                    <div class="form-check form-switch mt-2" id="sleepModeDiv" style="text-align: left;">
	         {% if form.sleep_mode_switcher.data == "Enable" %}
                        <input class="form-check-input" type="checkbox" id="switchSleepMode" onchange="checkboxSleepMode(this);" checked> <!-- submit_sleep_mode_option(); -->
                        {% else %}
	         <input class="form-check-input" type="checkbox" id="switchSleepMode" onchange="checkboxSleepMode(this);"> <!-- submit_sleep_mode_option(); -->
                        {% endif %}
	         <label class="form-check-label" for="switchSleepMode">Sleep Mode</label>
                    </div>
                    <div class="form-floating mt-2" id="sleepStartDiv">
                        <input type="time" class="form-control" id="floatingStartTime" value={{sleep_start_time}}>
                        <label for="floatingStartTime">Start Time</label>
                    </div>
                    <div class="form-floating mt-2" id="sleepEndDiv">
                        <input type="time" class="form-control" id="floatingEndTime" value={{sleep_end_time}}>
                        <label for="floatingEndTime">End Time</label>
                    </div>
                <!-- </form> -->
            </div>
            <div class="modal-footer">
            <div class="d-grid gap-2 d-md-block">
                <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#brightnessValue">Set Values</button>
                <button type="button" class="btn btn-primary" id="sleepModeButton" onclick="submitBrightnessMode()">Submit</button>
            </div>
            </div>
        </div>
        </div>
    </div>

    <!-- 預設播放模式Modal -->
    <div class="modal fade" id="defaultPlayMode" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticDefaultPlayMode" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="text-align:left">
            <div class="modal-header">
                <h5 class="modal-title" id="staticDefaultPlayMode">Default Setting</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <select class="form-select" id="floatingPlayMode" onchange="onchangeDefaultPlayMode()">
	                <option value={{default_play_form.launch_type_switcher.data}} selected disabled>{{default_play_form.launch_type_switcher.data}}</option>
                    {% for k,v in default_play_form.launch_type_switcher.choices %}
                        <option value="{{k}}">{{v}}</option>
	                {% endfor %}

                    </select>
                    <label for="floatingPlayMode">Play Mode</label>
                </div>

                <div class="form-floating mb-2" id="floatingPlayFileNameDiv">
                    <select class="form-select" id="floatingPlayFileName" onchange="">
                    <!-- <option selected disabled>Open this select menu</option> -->
	                <!-- value={{default_play_form.single_file_selectfiled.data}}不符合.webp格式 -->
	                <option selected disabled>{{default_play_form.single_file_selectfiled.data}}</option>
	                {% for k,v in files.items() %}
                      <option value="{{v}}">{{k}}</option>
	                {% endfor %}
                    </select>
                    <label for="floatingPlayFileName">Play File Name</label>
                </div>

                <div class="form-floating" id="floatingDefaultPlaylistNameDiv">
                    <select class="form-select" id="floatingDefaultPlaylistName" onchange="">
                    <!-- <option selected disabled>Open this select menu</option> -->
					<option selected disabled>{{default_play_form.playlist_selectfield.data}}</option>
	                {% for k,v in playlist_nest_dict.items() %}
                      <option value="{{v}}">{{k}}</option>
	                {% endfor %}
                    </select>
                    <label for="floatingDefaultPlaylistName">Playlist Name</label>
                </div>
            </div>

            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" onclick="submit_default_play_mode()">Submit</button>
            </div>
        </div>
        </div>
    </div>

    <!-- 上傳檔案Modal -->
    <div class="modal fade" id="mediaFileUpload" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticMediaFileUpload" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticMediaFileUpload">Choose a file</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form enctype="multipart/form-data" action="uploads" method="POST">
              <div class="modal-body input-group">
                <!-- <div class=""> -->
                <input id="inputFile" type="file" name="file" class="form-control" accept=".jpeg,.jpg,.png,.mp4" onchange="checkFile()">  <!-- multiple -->
                <!-- </div> -->
              </div>
              <div class="modal-footer">
                <button id="uploadButton" type="submit" class="btn btn-primary" onclick="location.reload()">Submit</button>
              </div>
            </form>
        </div>
        </div>
    </div>

    <!-- Still Image Period Modal -->
    <div class="modal fade" id="id_image_period" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="image_period" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="image_period">Still Image Period</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingImagePeriod" onchange="checkValue0_6000(this.id)" value= {{ still_image_period }}>
                    <label for="floatingImagePeriod">Still Image Period(Secs)</label>
                </div>
            </div>

            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">
                    <button type="button" id="SetStillImagePeriod" data-bs-dismiss="modal"  class="btn btn-danger" onclick="submit_period_option()">Set</button>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- ICLed Type Gain Modal -->
    <div class="modal fade" id="id_icled_type_gain" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="icled_type_gain" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="icled_type_gain">ICLed Type/Gain</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <select class="form-select" id="floatingICLedType" onchange="onchangeDefaultPlayMode()">
	                <option value={{default_play_form.icled_type_switcher.data}} selected disabled>{{default_play_form.icled_type_switcher.data}}</option>
                    {% for k,v in default_play_form.icled_type_switcher.choices %}
                        <option value="{{k}}">{{v}}</option>
	                {% endfor %}

                    </select>
                    <label for="floatingICLedType">ICLed Type</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingRedGain" onchange="checkValue0_15(this.id)" value={{ icled_current_gain_values.led_r_gain }}>
                    <label for="floatingRedGain">Red Gain</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingGreenGain" onchange="checkValue0_15(this.id)" value={{ icled_current_gain_values.led_g_gain }}>
                    <label for="floatingGreenGain">Green Gain</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingBlueGain" onchange="checkValue0_15(this.id)" value={{ icled_current_gain_values.led_b_gain }}>
                    <label for="floatingBlueGain">Blue Gain</label>
                </div>
            </div>

            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">
                    <button type="button" id="SetICLedTypeGain" data-bs-dismiss="modal"  class="btn btn-danger" onclick="submit_icled_type_gain_option()">Set</button>
                </div>
            </div>
        </div>
        </div>
    </div>



    <!-- Set Frame res/fps Modal -->
    <div class="modal fade" id="id_frame_res_fps" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="frame_res_fps" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="frame_res_fps">LED FrameRate/Res</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingFrameWidth" onchange="checkValue0_1280(this.id)" value={{ frame_res_rate_values.output_frame_width }}>
                    <label for="floatingFrameWidth">Frame Width</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingFrameHeight" onchange="checkValue0_720(this.id)" value={{ frame_res_rate_values.output_frame_height }}>
                    <label for="floatingFrameHeight">Frame Height</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingFrameFPS" placeholder="25" onchange="checkValue0_30(this.id)" value={{ frame_res_rate_values.output_fps }}>
                    <label for="floatingFrameFPS">Frame Rate</label>
                </div>
            </div>
            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">

                    <button type="button" id="SetResFPS" data-bs-dismiss="modal"  class="btn btn-danger" onclick="submit_framerate_res_option()">Set</button>


                </div>
            </div>
        </div>
        </div>
    </div>


    <!-- Media File Crop Modal -->
    <div class="modal fade" id="id_media_crop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="media_crop" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="media_crop">Set Media Crop</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingMediaCropStartX" onchange="checkValue0_1920(this.id)" value={{ media_crop_values.media_file_start_x }}>
                    <label for="floatingMediaCropStartX">Media Crop Start X</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingMediaCropStartY" onchange="checkValue0_1080(this.id)" value={{ media_crop_values.media_file_start_y }}>
                    <label for="floatingMediaCropStartY">Media Crop Start Y</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingMediaCropWidth" onchange="checkValue0_1920(this.id)" value={{ media_crop_values.media_file_crop_w }}>
                    <label for="floatingMediaCropWidth">Media Crop Width</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingMediaCropHeight" onchange="checkValue0_1080(this.id)" value={{ media_crop_values.media_file_crop_w }}>
                    <label for="floatingMediaCropHeight">Media Crop Height</label>
                </div>
            </div>
            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">
                    <button type="button" id="SetMediaCrop" data-bs-dismiss="modal"  class="btn btn-danger" onclick="submit_media_crop_option()">Set</button>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- HDMI_In Crop Modal -->
    <div class="modal fade" id="id_hdmi_crop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="hdmi_crop" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="hdmi_crop">Set HDMI_In Crop</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingHDMICropStartX" onchange="checkValue0_1920(this.id)" value={{ hdmi_crop_values.hdmi_in_start_x }}>
                    <label for="floatingHDMICropStartX">HDMI_In Crop Start X</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingHDMICropStartY" onchange="checkValue0_1080(this.id)" value={{ hdmi_crop_values.hdmi_in_start_y }}>
                    <label for="floatingHDMICropStartY">HDMI_In Crop Start Y</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingHDMICropWidth" onchange="checkValue0_1920(this.id)" value={{ hdmi_crop_values.hdmi_in_crop_w }}>
                    <label for="floatingHDMICropWidth">HDMI_In Crop Width</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingHDMICropHeight" onchange="checkValue0_1080(this.id)" value={{ hdmi_crop_values.hdmi_in_crop_h }}>
                    <label for="floatingHDMICropHeight">HDMI_In Crop Height</label>
                </div>
            </div>
            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">
                    <button type="button" id="SetHDMICrop" data-bs-dismiss="modal"  class="btn btn-danger" onclick="submit_hdmi_crop_option()">Set</button>
                </div>
            </div>
        </div>
        </div>
    </div>


    <!-- Audio/Preview Modal -->
    <div class="modal fade" id="id_audio_preview" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="audio_preview" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="audio_preview">Set Audio/Preview</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingAudio" onchange="checkValue0_1(this.id)" value={{ audio_enable }}>
                    <label for="floatingAudio">Audio Enable</label>
                </div>
                <div class="form-floating mb-2">
                    <input type="number" class="form-control" id="floatingPreview" onchange="checkValue0_1(this.id)" value={{ preview_enable }}>
                    <label for="floatingPreview">Preview Enable</label>
                </div>
            </div>
            <div class="modal-footer">
                <div class="d-grid gap-2 d-md-block">
                    <button type="button" id="SetAudioPreview" data-bs-dismiss="modal"  class="btn btn-danger" onclick="submit_audio_preview_option()">Set</button>
                </div>
            </div>
        </div>
        </div>
    </div>


    <script>
        $(function(){
            $("#sleepModeDiv").hide();
            $("#sleepStartDiv").hide();
            $("#sleepEndDiv").hide();
            $("#uploadButton").hide();
            // $("#removePlaylist").hide();
            // $("#newPlaylist").hide();
            // $("#addToPlaylist").hide();
            $("#floatingPlayFileNameDiv").hide();
            $("#floatingDefaultPlaylistNameDiv").hide();
            if(!$("#switchReboot").is(":checked")){
                $("#rebootDiv").hide();
            }

            var playlist_items = jsonstr;
            //console.log(Object.keys(playlist_items).length);
            var test_items=[];
            for (let i=0; i<Object.keys(playlist_items).length; i++){
                new_item = {"name": Object.keys(playlist_items)[i]};
                test_items.push(new_item);
            }
            //console.log("test_items = " + test_items[0]);

            // Media File's context menu
            $.contextMenu({
                selector: '.contextMediaFile',
                className: 'context',
                callback: function(key, options) {
                    var id = options.$trigger.attr("id");
                    var name = options.$trigger.attr("name");
                    console.log("id : " + id + "  name : " + name);
                    // var m = "clicked: " + key;
                    // alert(m);
                    switch(key){
                        case "delete":
                            Swal.fire({
                                title: 'Are you sure?',
                                text: "You won't be able to revert this!",
                                icon: 'warning',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Yes, delete it!'
                            }).then((result) => {
                                if (result.isConfirmed) {
                                    remove_media_file(name);
									deleteConfirm();
                                    // console.log("key = " + key);
									/*
                                    Swal.fire(
                                        'Deleted!',
                                        'Your file has been deleted.',
                                        'success'
                                    )
									*/
                                }
                            })
                            break;
                        case "addNew":
	                        create_new_playlist(name);
                            // createPlaylist();
                            // $('#playList').modal('show');
                            // $("#addToPlaylist").show();
                            // $("#removePlaylist").hide();
                            // $("#newPlaylist").hide();
                            break;
                        default:
                            if(key >= 0){
                                var playlist_tmp = Array.from(Object.keys(playlist_items)[key]);
                                var playlist = playlist_tmp.join("");
                                add_to_playlist(name, playlist);
                                console.log("name = " + name);
                                console.log("playlist = " + playlist);
                            }
                            break;
                    }
                },
                items: {
                    "delete": {name: "Remove this file", icon: "fa-solid fa-folder-minus"},
                    //"addExisting": {name: "Add to existing playlist", icon: "fa-solid fa-folder-plus"},
                    "addNew": {name: "Add to new playlist", icon: "fa-solid fa-folder-plus"},
	                "addToPlaylist": {
                        name: "Add to existing playlist",
                        icon: "fa-solid fa-folder-plus",
                        "items": test_items
                    }
                }
            });

            // Remove a file from playlist's context menu
            $.contextMenu({
                selector: '.playListContext',
	            className: 'context',
                callback: function(key, options) {
                    Swal.fire({
                        title: 'Are you sure?',
                        text: "You won't be able to revert this!",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, delete it!'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            var name = $("#floatingPlaylistName option:selected").text();
                            var id = options.$trigger.attr("id");
                            console.log("name = "+ name);
                            console.log("id = "+ id);
							remove_file_from_playlist(name, id);
                            deleteConfirm();
							//location.reload();
                        }
                    })
                },
                items: {
                    "delete": {name: "Remove from playlist", icon: "fa-solid fa-folder-minus"}
                }
            });

            // $('#modalImgDiv').on('click', function(e){
            //     console.log('clicked', this);
            // })
        });

        // $('input[type="radio"][name="brightnessRadio"]').on('change', function() {
        //     switch($(this).val()) {
        //         case '1':
        //             $("#sleepModeDiv").show();
        //             checkboxSleepMode($("#switchSleepMode").is(":checked"));
        //             if($("#switchSleepMode").is(":checked")){
        //                 $("#sleepStartDiv").show();
        //                 $("#sleepEndDiv").show();
        //             }
        //             break;
        //         case '2':
        //             $("#sleepModeDiv").hide();
        //             $("#sleepStartDiv").hide();
        //             $("#sleepEndDiv").hide();
        //             break;
        //         default:
        //             $("#sleepModeDiv").hide();
        //             break;
        //     }
        //     console.log($(this).val());
        //     console.log($("#switchSleepMode").is(":checked"));
        // });

        /*
        function showPlaylistButton() {
            $("#removePlaylist").show();
            $("#newPlaylist").show();
            $("#addToPlaylist").hide();
        }
        */
		function deleteConfirm(){
			Swal.fire({
				icon: 'success',
				title: 'Your file has been deleted.',
				showConfirmButton: false,
            })
			setTimeout(function(){
				Swal.close();
				window.location.reload();
			}, 1600);
		}

        function checkFile(){
            var fileInput = $("#inputFile").val().split('\\').pop();
            if(fileInput.endsWith("mp4") || fileInput.endsWith("jpg") || fileInput.endsWith("jpeg") || fileInput.endsWith("png")){//
				var spot = fileInput.split('.').length - 1;
				//console.log("spot = " + spot);
				if(spot > 1){
					Swal.fire({
						icon: 'error',
						title: 'File name is illegal',
						text: 'Over one spot in file name'
					})
					$("#uploadButton").hide();
					console.log("File name spot = " + spot);
				}else{
					console.log("fileInput = " + fileInput);
					$("#uploadButton").show();
				}
			}else{
				Swal.fire({
					icon: 'error',
					title: 'Data type not allowed',
					text: 'Only allow jpg, jpeg, png and mp4.'
				})
				$("#uploadButton").hide();
			}
        }

        function ICLEDsetting(){
            var input = $( "#floatingICLED option:selected" ).text();
            console.log("ICLED option = " + input);
        }

        function currentGainSetting(){
            var red = $("#floatingRed").val();
            var green = $("#floatingGreen").val();
            var blue = $("#floatingBlue").val();
            console.log("red = " + red);
            console.log("green = " + green);
            console.log("blue = " + blue);
        }

        function onchangePlaylist() {
			document.getElementById("modalImgDiv").innerHTML = '';
            var input = $("#floatingPlaylistName").val();
			input = input.replaceAll("'", "\"");
			console.log('input:' + input)
			var obj = JSON.parse(input, function(key, value) {
				if (value.toString().endsWith('webp')){
					document.getElementById("modalImgDiv").innerHTML += '<img class="w-75 img-thumbnail playListContext" id="' + key + '" src="./get_thumbnail/' + value + '" />';
					console.log("key = " + key);
					console.log("value = " + value);
				}
			});
            // var inputPlaylist = $( "#floatingPlaylistName option:selected" ).text();
			/* // 舊寫法
            input = input.replaceAll(":", ",");
            input = input.replaceAll(" ", "");
            input = input.replaceAll("'", "");
            input = input.replace("{", "");
            input = input.replace("}", "");
            var split_string = input.split(",");
            console.log("split_string = " + split_string);

            document.getElementById("modalImgDiv").innerHTML = '';
            for(let i=1; i<split_string.length; i+=2){
                // document.getElementById("modalImgDiv").innerHTML += '<img class="w-75 img-thumbnail playListContext" id="' + split_string[i-1] + '" src="./get_thumbnail/' + split_string[i] + '" onclick="play_playlist(\'' + inputPlaylist + '\')" />';
                document.getElementById("modalImgDiv").innerHTML += '<img class="w-75 img-thumbnail playListContext" id="' + split_string[i-1] + '" src="./get_thumbnail/' + split_string[i] + '" />';
				console.log("id = " + split_string[i-1]);
				console.log("split_string = " + split_string[i]);
            }
			*/
        }

        function checkValue0_15(value){
            var input = $("#" + value).val();
            console.log("input = " + input);
            if(input > 15 || input < 0){
                Swal.fire({
                    icon: 'warning',
                    text: 'Input should between 0 to 15',
                    showConfirmButton: false,
                    timer: 2000
                })
            }
        }

        function checkValue0_100(value){
            var input = $("#" + value).val();
            console.log("input = " + input);
            if(input > 100 || input < 0){
                Swal.fire({
                    icon: 'warning',
                    text: 'Input should between 0 to 100',
                    showConfirmButton: false,
                    timer: 2000
                })
            }
        }

        function checkValue0_1920(value){
            var input = $("#" + value).val();
            console.log("input = " + input);
            if(input > 1920 || input < 0){
                Swal.fire({
                    icon: 'warning',
                    text: 'Input should between 0 to 1920',
                    showConfirmButton: false,
                    timer: 2000
                })
            }
        }

        function checkValue0_1080(value){
            var input = $("#" + value).val();
            console.log("input = " + input);
            if(input > 1080 || input < 0){
                Swal.fire({
                    icon: 'warning',
                    text: 'Input should between 0 to 1080',
                    showConfirmButton: false,
                    timer: 2000
                })
            }
        }

        function checkboxSleepMode(value){
            if(value.checked){
                $("#sleepStartDiv").show();
                $("#sleepEndDiv").show();
                //$("#sleepModeButton").attr("onclick", "submit_sleep_time_option();submitBrightnessMode();");
                // $("#sleepModeButton").attr("data-bs-dismiss", null);
                // document.getElementById("sleepModeButton").innerHTML ='<button type="submit" class="btn btn-primary" onclick="submit_sleep_time_option()">Submit</button>';
            }else{
                $("#sleepStartDiv").hide();
                $("#sleepEndDiv").hide();
                //$("#sleepModeButton").attr("onclick", "submitBrightnessMode()");
                // $("#sleepModeButton").attr("data-bs-dismiss", "modal");
            }
            // console.log("checkboxSleepMode: " + $("#switchSleepMode").is(":checked"));
        }

        function checkboxReboot(value){
            if(value.checked){
                $("#rebootDiv").show();
                $("#rebootSubmit").attr("onclick", "submit_reboot_time_option()");
                // $("#rebootNowButton").hide();
                // $("#rebootLaterButton").show();
            }else{
                // $("#rebootButton").show();
                $("#rebootDiv").hide();
                $("#rebootSubmit").attr("onclick", null);
                // $("#rebootNowButton").show();
                // $("#rebootLaterButton").hide();
            }
            console.log(value.checked);
        }

        function selectBrightnessMode(){
            var brightnessMode = document.getElementById("floatingBrightnessMode").value;
            switch(brightnessMode){
                case "Time Mode":
                    $("#sleepModeDiv").show();
                    if($("#switchSleepMode").is(":checked")){
                        $("#sleepStartDiv").show();
                        $("#sleepEndDiv").show();
                    }
                    break;
				/*
                case "Fix Mode":
                    $("#sleepModeDiv").hide();
                    $("#sleepStartDiv").hide();
                    $("#sleepEndDiv").hide();
                    break;
				*/
                default:
                    $("#sleepModeDiv").hide();
                    $("#sleepStartDiv").hide();
                    $("#sleepEndDiv").hide();
                    break;
            }
            //console.log("val : " + brightnessMode);
        }

		// set 1.city  2.Brightness Mode  3.sleepMode & sleepTime
        function submitBrightnessMode(){
            var city = $("#floatingCity option:selected").text();
            var brightnessModeTxt = $("#floatingBrightnessMode option:selected").text();
            var brightnessMode = $("#floatingBrightnessMode option:selected").val();
			/*
			switch(brightnessMode){
				case "Fix Mode":
					brightnessMode = "0";
					break;
				case "Time Mode":
					brightnessMode = "1";
					break;
				case "ALS Mode":
					brightnessMode = "2";
					break;
				case "Test Mode":
					brightnessMode = "3";
					break;
				default:
					break;
			}
			*/

			//console.log("text : " + brightnessMode);

			// Brightness Mode; value=0, 1, 2, 3...
			var url = "/set_brightness_algo/" + brightnessMode;
			$.post(url, {});
			console.log("Brightness Mode : " + url);

			// city; value=Taipei, Taichung, Taoyuan, kaohsiung
            url = "/set_target_city/" + city;
            $.post(url, {});
			console.log("city_select : " + url);

            if(brightnessMode == "Time Mode"){
				var sleepMode;
                if($("#switchSleepMode").is(":checked")){
                    var startTime = $("#floatingStartTime").val();
                    var endTime = $("#floatingEndTime").val();
                    if(!startTime || !endTime){
                        Swal.fire({
                            icon: 'error',
                            title: 'Input cannot be empty',
                        })
                    }else{
                        Swal.fire({
                            icon: 'success',
                            title: 'Set Data',
                            html:
                                '<table class="table table-striped table-bordered" style="text-align: left;">' +
                                '<tr>' +
                                    '<td>City</td>' +
                                    '<td>' + city + '</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td>Brightness Mode</td>' +
                                    '<td>' + brightnessModeTxt + '</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td>Sleep Mode</td>' +
                                    '<td>ON</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td>Start Time</td>' +
                                    '<td>' + startTime + '</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td>End Time</td>' +
                                    '<td>' + endTime + '</td>' +
                                '</tr>' +
                                '</table>',
                        })

						// 先設定完sleepMode, 再寫入sleepTime
						sleepMode = "Enable";
						//url = "/set_sleep_mode/" + sleepMode;
						//$.post(url, {});
						//console.log('SleepMode : ' + sleepMode);

						// Sleep Mode : set sleep & end time
						var sleepTime = startTime + ";" + endTime;
						url = "/set_sleep_time/" + sleepTime;
						$.post(url, {});
                        console.log("Sleep Mode : " + url);

                        $('#brightnessMode').modal('hide');
                    }
                }else{
					sleepMode = "Disable";
					//url = "/set_sleep_mode/" + sleepMode;
					//$.post(url, {});
					//console.log('SleepMode : ' + url);
                    Swal.fire({
                        icon: 'success',
                        title: 'Set Data',
                        html:
                            '<table class="table table-striped table-bordered" style="text-align: left;">' +
                            '<tr>' +
                                '<td>City</td>' +
                                '<td>' + city + '</td>' +
                            '</tr>' +
                            '<tr>' +
                                '<td>Brightness Mode</td>' +
                                '<td>' + brightnessModeTxt + '</td>' +
                            '</tr>' +
                            '<tr>' +
                                '<td>Sleep Mode</td>' +
                                '<td>OFF</td>' +
                            '</tr>' +
                            '</table>',
                    })
                    $('#brightnessMode').modal('hide');
                }
				// Sleep Mode; value=Disable, Enable
				url = "/set_sleep_mode/" + sleepMode;
				$.post(url, {});
				console.log('SleepMode : ' + url);
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
                    html:
                        '<table class="table table-striped table-bordered" style="text-align: left;">' +
                        '<tr>' +
                            '<td>City</td>' +
                            '<td>' + city + '</td>' +
                        '</tr>' +
                        '<tr>' +
                            '<td>Brightness Mode</td>' +
                            '<td>' + brightnessModeTxt + '</td>' +
                        '</tr>' +
                        '</table>',
                })
                $('#brightnessMode').modal('hide');
            }
        }

        function onchangeDefaultPlayMode(){
            var input = $("#floatingPlayMode").val();
            switch(input){
                case "single_file_mode":
                    $("#floatingPlayFileNameDiv").show();
                    $("#floatingDefaultPlaylistNameDiv").hide();
                    break;
                case "playlist_mode":
                    $("#floatingPlayFileNameDiv").hide();
                    $("#floatingDefaultPlaylistNameDiv").show();
                    break;
                default:
                    $("#floatingPlayFileNameDiv").hide();
                    $("#floatingDefaultPlaylistNameDiv").hide();
                    break;
            }


        }

        /* 以下開始為功能串接程式 */
        // 刪掉某個playlist
        function remove_playlist() {
            var input = $("#floatingPlaylistName option:selected").text();
            if(input == "Choose a playlist"){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
					title: 'Are you sure?',
					text: "You won't be able to revert this!",
					icon: 'warning',
					showCancelButton: true,
					confirmButtonColor: '#3085d6',
					cancelButtonColor: '#d33',
					confirmButtonText: 'Yes, delete it!'
	            }).then((result) => {
					if (result.isConfirmed) {
						var url = "/remove_playlist/" + input;
						console.log("playlist = " + input);
						$.post(url, {});
						deleteConfirm();
						/*
						Swal.fire(
							'Deleted!',
							'Your file has been deleted.',
							'success'
						)
						*/
					}
	            })
            }
        }

        // Brightness Value
        function submit_frame_brightness_values_option(){
            var fr_br = document.getElementById("floatingFrameBrightness").value;
            var day_mode_fr_br = document.getElementById("floatingDayModeFrameBrightness").value;
            var night_mode_fr_br = document.getElementById("floatingNightModeFrameBrightness").value;
            var sleep_mode_fr_br = document.getElementById("floatingSleepModeFrameBrightness").value;
            if(!fr_br || !day_mode_fr_br || !night_mode_fr_br || !sleep_mode_fr_br){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(fr_br>100 || fr_br<0 || day_mode_fr_br>100 || day_mode_fr_br<0
            || night_mode_fr_br>100 || night_mode_fr_br<0 || sleep_mode_fr_br>100 || sleep_mode_fr_br<0){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#brightnessValue').modal('hide');
                var data = "fr_br:" + fr_br + ";day_mode_fr_br:" + day_mode_fr_br +";night_mode_fr_br:" + night_mode_fr_br + ";sleep_mode_fr_br:" + sleep_mode_fr_br;
                /*alert("data : " + data)*/
                console.log('Brightness Value : ' + data);
                var url = "/set_brightness_values/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        //submit_icled_type_gain_option
        //Set ICLed Type & Gain
        function submit_icled_type_gain_option(){
            var icled_type = document.getElementById("floatingICLedType").value;
            var r_gain = document.getElementById("floatingRedGain").value;
            var g_gain = document.getElementById("floatingGreenGain").value;
            var b_gain = document.getElementById("floatingBlueGain").value;

            if(!icled_type ){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(r_gain > 15 || r_gain < 0 || g_gain > 15 || g_gain < 0 || b_gain > 15 || b_gain < 0){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#id_icled_type_gain').modal('hide');
                var data = "icled_type:" + icled_type + ";r_gain:" + r_gain + ";g_gain:" + g_gain + ";b_gain:" + b_gain;
                /*alert("data : " + data)*/
                console.log('icled_type_gain : ' + data);
                var url = "/set_icled_type_gain/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        // Image Period Value
        function submit_period_option(){
            var period = document.getElementById("floatingImagePeriod").value;

            if(!period ){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(period > 60000 || period<0 ){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#id_frame_res_fps').modal('hide');
                var data = "period:" + period;
                /*alert("data : " + data)*/
                console.log('image period : ' + data);
                var url = "/set_image_period_values/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        // Framerate/FPS Value
        function submit_framerate_res_option(){
            var fr_w = document.getElementById("floatingFrameWidth").value;
            var fr_h = document.getElementById("floatingFrameHeight").value;
            var fr_fps = document.getElementById("floatingFrameFPS").value;

            if(!fr_w || !fr_h || !fr_fps ){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(fr_w>1280 || fr_w<16 || fr_h>720 || fr_h<0
            || fr_fps>30 || fr_fps<0 ){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#id_frame_res_fps').modal('hide');
                var data = "fr_w:" + fr_w + ";fr_h:" + fr_h +";fr_fps:" + fr_fps;
                /*alert("data : " + data)*/
                console.log('Frame data : ' + data);
                var url = "/set_frame_rate_res_values/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        // Framerate/FPS Value
        function submit_audio_preview_option(){
            var audio_enable = document.getElementById("floatingAudio").value;
            var preview_enable = document.getElementById("floatingPreview").value;

            if(!audio_enable || !preview_enable ){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(audio_enable >1 || audio_enable < 0 || preview_enable > 1  || preview_enable < 0){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#id_audio_preview').modal('hide');
                var data = "audio_enable:" + audio_enable + ";preview_enable:" + preview_enable;
                /*alert("data : " + data)*/
                console.log('Audio/Preview data : ' + data);
                var url = "/set_audio_preview_res_values/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        // Media Crop Value
        function submit_media_crop_option(){
            var media_crop_start_x = document.getElementById("floatingMediaCropStartX").value;
            var media_crop_start_y = document.getElementById("floatingMediaCropStartY").value;
            var media_crop_width = document.getElementById("floatingMediaCropWidth").value;
            var media_crop_height = document.getElementById("floatingMediaCropHeight").value;

            if(!media_crop_start_x || !media_crop_start_y || !media_crop_width || !media_crop_height  ){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(media_crop_start_x >1920 || media_crop_start_x < 0 ||
                        media_crop_start_y > 1080  || media_crop_start_y < 0 ||
                        media_crop_width > 1920 || media_crop_width < 0 ||
                        media_crop_height > 1920 || media_crop_height < 0){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#id_media_crop').modal('hide');
                var data = "media_crop_start_x:" + media_crop_start_x + ";media_crop_start_y:" + media_crop_start_y +
                            ";media_crop_width:" + media_crop_width + ";media_crop_height:" + media_crop_height;
                /*alert("data : " + data)*/
                console.log('HDMI_In Crop data : ' + data);
                var url = "/set_media_crop_res_values/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        // HDMI Crop Value
        function submit_hdmi_crop_option(){
            var hdmi_crop_start_x = document.getElementById("floatingHDMICropStartX").value;
            var hdmi_crop_start_y = document.getElementById("floatingHDMICropStartY").value;
            var hdmi_crop_width = document.getElementById("floatingHDMICropWidth").value;
            var hdmi_crop_height = document.getElementById("floatingHDMICropHeight").value;

            if(!hdmi_crop_start_x || !hdmi_crop_start_y || !hdmi_crop_width || !hdmi_crop_height  ){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(hdmi_crop_start_x >1920 || hdmi_crop_start_x < 0 ||
                        hdmi_crop_start_y > 1080  || hdmi_crop_start_y < 0 ||
                        hdmi_crop_width > 1920 || hdmi_crop_width < 0 ||
                        hdmi_crop_height > 1920 || hdmi_crop_height < 0){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#id_hdmi_crop').modal('hide');
                var data = "hdmi_in_crop_start_x:" + hdmi_crop_start_x + ";hdmi_in_crop_start_y:" + hdmi_crop_start_y +
                            ";hdmi_in_crop_width:" + hdmi_crop_width + ";hdmi_in_crop_height:" + hdmi_crop_height;
                /*alert("data : " + data)*/
                console.log('HDMI_In Crop data : ' + data);
                var url = "/set_hdmi_crop_res_values/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
            }
        }

        function submit_aio_frame_brightness_values_option(){
            var fr_br = document.getElementById("floatingFrameBrightness").value;
            if(!fr_br){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
            }else if(fr_br>100 || fr_br<0){
                Swal.fire({
                    icon: 'error',
                    title: 'Illegal Value',
					showConfirmButton: false,
                    timer: 2000
                })
            }else{
                Swal.fire({
                    icon: 'success',
                    title: 'Set Data',
					showConfirmButton: false,
                    timer: 2000
                })
                $('#brightnessValue').modal('hide');
                var data = "fr_br:" + fr_br + ";day_mode_fr_br:" + fr_br +";night_mode_fr_br:" + fr_br + ";sleep_mode_fr_br:" + fr_br;
                var url = "/set_brightness_values/" + data;
                $.post(url, {});
            }
        }

        // Default Mode Setting
        function submit_default_play_mode(){
            // var mode = document.querySelector('input[name="launch_type_switcher"]:checked').value;
            var mode = $("#floatingPlayMode").val();
            var modeName = $("#floatingPlayMode option:selected").text();
            var param = "";
            console.log('mode = ' + mode);
            console.log('modeName = ' + modeName);
            console.log(param);
            switch(mode){
                case "single_file_mode":
                    param = $("#floatingPlayFileNameDiv option:selected").text();
                    //modeName = "Single File Mode";
                    console.log('PlayFileName = ' + param);
					if(!param){
						Swal.fire({
                            icon: 'error',
                            title: 'Input cannot be empty',
							showConfirmButton: false,
                            timer: 2000
                        })
					}
                    break;
                case "playlist_mode":
                    param = $("#floatingDefaultPlaylistNameDiv option:selected").text();
                    //modeName = "Playlist Mode";
                    console.log('DefaultPlaylistName = ' + param);
					if(!param){
						Swal.fire({
                            icon: 'error',
                            title: 'Input cannot be empty',
							showConfirmButton: false,
                            timer: 2000
                        })
					}
                    break;
                case "none_mode":
                    //modeName = "Standby Mode";
                    break;
				case "hdmi_in_mode":
                    //modeName = "Standby Mode";
                    break;
				case "cms_mode":
                    //modeName = "Standby Mode";
                    break;
                default:
                    break;
            }
            Swal.fire({
				icon: 'success',
                title: modeName + ' Mode',
				text: param,
                showConfirmButton: false,
                timer: 2000
            })
			$('#defaultPlayMode').modal('hide');
               data = mode + ":" + param;
               var url = "/set_default_play_mode/" + data;
               $.post(url, {});

			}

        // play media file
        function play(data){
            var url = "/play/" + data;
            $.post(url, {});
        }

        // play playlist
        function play_playlist(){
            var inputPlaylist = $( "#floatingPlaylistName option:selected" ).text();
            if(inputPlaylist == "Choose a playlist"){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
				return;
            }
            //console.log("data = " + data);
            var url = "/play_playlist/" + inputPlaylist;
            $.post(url, {});
        }

        function add_to_playlist(file, playlist) {
            var data = "playlist_name:" + playlist + ";file_name:" + file;
            var url = "/add_to_playlist/" + data;
            $.post(url, {});
			Swal.fire({
                icon: 'success',
                title: 'Add to ' + playlist,
                showConfirmButton: false
            })
			setTimeout(function(){
				Swal.close();
				window.location.reload();
			}, 1600);
        }

        // Brightness Mode; value=0, 1, 2, 3...
		/*
        function submit_frame_brightness_mode_option(){
            // var data = document.querySelector('input[name="brightness_mode_switcher"]:checked').value;
            var data = document.getElementById("floatingBrightnessMode").value;
            // alert("data:" + data);
            console.log('BrightnessMode : ' + data);
            var url = "/set_brightness_algo/" + data;
            $.post(url, {});
        }
		*/

        // Sleep Mode; value=Disable, Enable
		/*
        function submit_sleep_mode_option(){
            var data;
            if($("#switchSleepMode").is(":checked")){
                data = "Enable";
            }else{
                data = "Disable";
            }
            // alert(data);
            console.log('SleepMode : ' + data);
            var url = "/set_sleep_mode/" + data;
            $.post(url, {});
        }
		*/

        // Sleep Mode : set sleep & end time
		/*
        function submit_sleep_time_option(){
            var sleep_start_time = document.getElementById("floatingStartTime").value;
            var sleep_end_time = document.getElementById("floatingEndTime").value;

            // const getSeconds = s => s.split(":").reduce((acc, curr) => acc * 60 + +curr, 0);
            // var startSeconds = getSeconds(sleep_start_time);
            // var endSeconds = getSeconds(sleep_end_time);
            if (!sleep_start_time || !sleep_end_time) {
                console.log('time input empty');
                return;
            }
            // Swal.fire({
            //     icon: 'success',
            //     title: 'Sleep from ' + sleep_start_time + ' to ' + sleep_end_time,
            // })
            data = sleep_start_time + ";" + sleep_end_time;
            var url = "/set_sleep_time/" + data;
            $.post(url, {});
        }
		*/

        // city; value=Taipei, Taichung, Taoyuan, kaohsiung
		/*
        function submit_target_city_option(){
            var city_select = document.getElementById("floatingCity").value;
            // Swal.fire({
            //     icon: 'success',
            //     title: 'Selected City : ' + city_select,
            // })
            // alert(city_select);
            console.log("city_select : " + city_select);
            var url = "/set_target_city/" + city_select;
            $.post(url, {});
        }
		*/

        // Set HDMI In
        function submit_hdmi_in(data){
            /*var data = "hdmi_in_start"*/
            /*alert(data);*/
            var url = "/play_hdmi_in/" + data;
            $.post(url, {
                /*javascript_data: data*/
                });
        }

        // Set CMS Start
        function submit_cms_start(data){
            /*var data = "hdmi_in_start"*/
            /*alert(data);*/
            var url = "/play_cms/" + data;
            $.post(url, {
                /*javascript_data: data*/
                });
        }

        // 跑馬燈 play text 設定
        function submit_text_content(){
            /*alert("submit_text_content")*/
            var text_context = $("#floatingTextContext").val(); // data1
            var text_font_size = document.getElementById('floatingFontSize').value; //data2
            var text_speed = document.getElementById("floatingTextSpeed").value;
            var text_position = document.getElementById("floatingTextPosition").value;
            var text_period = document.getElementById("floatingTextPeriod").value;

            if(!text_context || !text_font_size || !text_speed || !text_position || !text_period){
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
                })
                return;
            }

            console.log('text_speed : ' + text_speed);
            console.log('text_position : ' + text_position);
            console.log('text_period : ' + text_period);
            console.log('text_context : ' + text_context);
            console.log('text_font_size : ' + text_font_size);

            var url = "/set_text_speed/" + text_speed;
            $.post(url, {
                /*javascript_data: text_speed*/
                });

            var url = "/set_text_position/" + text_position;
            $.post(url, {
                /*javascript_data: text_position*/
                });

            var url = "/set_text_period/" + text_period;
            $.post(url, {
                /*javascript_data: text_period*/
                });

            var url = "/play_text/" + text_context;
            $.post(url, {
                /*javascript_data: data1*/
                });

            var url = "/set_text_size/" + text_font_size;
            $.post(url, {
                /*javascript_data: data2*/
                });
        }

        // Reboot
        function submit_reboot_time_option(){
            var data = document.getElementById("floatingRebootTime").value;
            if (!data) {
                // $("#rebootSubmit").attr("data-bs-dismiss", "modal");
                console.log('time input empty');
                Swal.fire({
                    icon: 'error',
                    title: 'Input cannot be empty',
					showConfirmButton: false,
                    timer: 2000
                })
                // $("#reboot").show();
                return;
            }
            // $("#rebootSubmit").attr("data-bs-dismiss", null);
            Swal.fire({
                icon: 'success',
                title: 'Reboot Time : ' + data,
				showConfirmButton: false,
                timer: 2000
            })
            // alert("Reboot Time : " + data);
            var url = "/set_reboot_time/" + data;
            $.post(url, {
                /*javascript_data: data*/
                });
        }

        // Reboot Switcher
        function submit_reboot_option(){
            var data;
            if($("#switchReboot").is(":checked")){
                data = "Enable";
            }else{
                data = "Disable";
            }
            // alert(data);
            console.log('Reboot Mode : ' + data);

            // var data = document.querySelector('input[name="reboot_mode_switcher"]:checked').value;
            // alert("Reboot Mode : " + data);
            var url = "/set_reboot_mode/" + data;
            $.post(url, {
                /*javascript_data: data*/
                });
        }

        // 還沒動
        // create playlist
        async function create_new_playlist(file) {
            const { value: playlistName } = await Swal.fire({
                title: 'Enter playlist name',
                input: 'text',
                inputLabel: 'New playlist name',
                // inputValue: inputValue,
                showCancelButton: true,
                inputValidator: (value) => {
                    if (!value) {
                        return 'You need to write something!'
                    }
                }
            })
            if (playlistName) {
                // Swal.fire(`New playlist name is ${playlistName}`)
				var data = "playlist_name:"+playlistName+";file_name:"+file;
                var url = "/create_new_playlist/" + data;
                $.post(url, {
                    /*javascript_data: data*/
                    });
                Swal.fire({
                    icon: 'success',
                    title: 'New playlist name : ' + playlistName,
                    showConfirmButton: false
                })
				setTimeout(function(){
					Swal.close();
					window.location.reload();
				}, 1600);
            }
        }

        function remove_file_from_playlist(playlist, file) {
            data = "playlist:" + playlist + ";file:" + file
            var url = "/remove_file_from_playlist/" + data;
            $.post(url, {});
        }

        // 還沒動
        function remove_media_file(data) {
            var url = "/remove_media_file/" + data;
            $.post(url, {
                /*javascript_data: data*/
                });
        }
        // $(document).ready(function(){
        //     // $("#carouselCaptions").carousel();
        //     alert(options.val());
        // });

        // $(".item").click(function(){
        //     $("").modal("show");
        // });
        // $(document).ready(function() {
        //     $("#myModal").modal("show");
        // });
        // $('#nav-tab a[href="#nav-playText"]').on('click', function (e) {
        //     e.preventDefault()
        //     $(this).tab('show')
        // })

        // $('#nav-tab a[href="#nav-mediaFiles"]').on('click', function (e) {
        //     e.preventDefault()
        //     $(this).tab('show')
        // })

        // $('#nav-tab a[href="#nav-playlists"]').on('click', function (e) {
        //     e.preventDefault()
        //     $(this).tab('show')
        // })

        // $('#nav-tab a[href="#nav-brightnessMode"]').on('click', function (e) {
        //     e.preventDefault()
        //     $(this).tab('show')
        // })
    </script>
</body>
</html>